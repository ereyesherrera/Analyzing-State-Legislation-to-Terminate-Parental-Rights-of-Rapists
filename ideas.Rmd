---
title: "Stats 112 Final Project"
author: "Edwin Reyes Herrera, Emma Higgins, Max Danielewicz, Will Hamlin"
date: "11/1/2019"
output: 
  html_document:
    keep_md: yes
    toc: true
    toc_float: yes
---

```{r warning=FALSE, message=FALSE}
library(gganimate)
library(ggmap)
library(ggridges)
library(ggthemes)
library(knitr)
library(leaflet)
library(lubridate)
library(plotly)
library(scales)
library(tidyverse)
```

## Other Interesting datasets
World Suicide Rates 1985-2016
https://www.kaggle.com/russellyates88/suicide-rates-overview-1985-to-2016

World Earthquakes 1965-2016
https://www.kaggle.com/usgs/earthquake-database

World Happinness 2015-2017
https://www.kaggle.com/unsdsn/world-happiness


## 1
(Max)

This is the College Scorecard Data Set. It has information on higher education institutions in the US, including: information about the institution, academics, admissions, costs, student body, financial aid, and completion. It also has data on earnings post-graduation. This is only the most recent data available (I belive it is 2017). There is another file that has a glossary for all of the terms, since they are abbreviated in this data set. I will work on uploading it. -Max
```{r, eval=FALSE}
library(readr)

Most_Recent_Cohorts_Scorecard_Elements <- 
  read_csv("C:/Users/maxda/Downloads/Most-Recent-Cohorts-Scorecard-Elements.csv")

View(Most_Recent_Cohorts_Scorecard_Elements)
```


## 2
(Edwin)

With the recent CA wildfires going on, I was interested in analyzing the history of wildfires in California. I found [this Buzzfeed article](https://www.buzzfeednews.com/article/peteraldhous/california-wildfires-people-climate) that did some analysis, but I think we would be able to expand it a bit more.

Buzzfeed provided the code to clean up and visualize the data the way they did [at this page](https://buzzfeednews.github.io/2018-07-wildfire-trends/) and they also provided their Github repo with their data [here](https://github.com/BuzzFeedNews/2018-07-wildfire-trends).

They retrieved their information from the [California Department of Forestry and Fire Protection (Cal Fire) Fire Perimeters Geodatabase](https://frap.fire.ca.gov/frap-projects/fire-perimeters/) and this will be a good resource since it explains all the variable names.

```{r, warning=FALSE, message=FALSE}
ca_fires <- read_csv("https://raw.githubusercontent.com/BuzzFeedNews/2018-07-wildfire-trends/master/data/calfire_frap.csv")
ca_damage <- read_csv("https://raw.githubusercontent.com/BuzzFeedNews/2018-07-wildfire-trends/master/data/calfire_damage.csv")
```

Number of days each fire burned
```{r}
ca_fires %>% 
  mutate(total_days = cont_date - alarm_date) %>% 
  
ggplot(aes(x = total_days)) +
  geom_histogram() +
  xlim(0, 180) +
  ylim(0, 1000) 
```

Causes of CA Fires - come back and put in the name for each number (see below - Edwin)

```{r}
cause_names <- tibble(
  cause = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19),
  cause_name = c("Lightning", "Equipment Use", "Smoking", "Campfire", "Debris", "Railroad", "Arson", "Playing with Fire", "Miscellaneous", "Vehicle", "Power Line", "Firefighter Training", "Non-Firefighter Training", "Unknown/Unidentified", "Structure", "Aircraft", "Volcanic", "Escaped Prescribed Burn", "Illegal Alien Campfire")
)
```

```{r}
# This uses info above to create new column in original data set to have name for each cause
ca_fires <- ca_fires %>%
  left_join(cause_names, by = "cause")
```


```{r}
ggplot(ca_fires, aes(x = cause)) +
  geom_bar() +
  coord_flip() +
  labs(title = "Causes of CA Fires", x = "Causes of Fire", y = "Number of Fires")
```

```{r}
ca_fires %>%
  group_by(cause_name) %>%
  count() %>%
  ggplot(aes(x = cause_name, y = n)) +
  geom_col() +
  coord_flip() +
  labs(title = "Causes of CA Fires", x = "Causes of Fire", y = "Number of Fires")
```


```{r}
# Summarizing total acres a fire spanned and number of structures destroyed in year
ca_fires %>%
  group_by(year_) %>%
  summarize(total_acres = sum(gis_acres, na.rm = TRUE)) %>%
  left_join(ca_damage, by = c("year_" = "year")) %>%
  arrange(desc(year_))
```

```{r}
ca_fires %>%
  group_by(year_) %>%
  summarize(total_acres = sum(gis_acres, na.rm = TRUE)) %>%
  left_join(ca_damage, by = c("year_" = "year")) %>%
  arrange(desc(year_)) %>%
  ggplot(aes(x = year_, y = total_acres)) +
  geom_line()

ca_fires %>%
  group_by(year_) %>%
  summarize(total_acres = sum(gis_acres, na.rm = TRUE)) %>%
  left_join(ca_damage, by = c("year_" = "year")) %>%
  arrange(desc(year_)) %>%
  ggplot(aes(x = year_, y = structures)) +
  geom_col()
```

```{r}
# Using buzzfeeds code to vategorize fires as 3 different causes
ca_fires <- ca_fires %>%
  mutate(cause2 = case_when(cause == 1 | cause == 17 ~ "Natural",
                            cause == 14 | is.na(cause) ~ "Unknown",
                            cause != 1 | cause != 14 | cause != 17 ~ "Human"))
```

```{r}
ca_fires %>%
  group_by(cause2) %>%
  count() %>%
  ggplot(aes(x = cause2, y = n)) +
  geom_col() +
  coord_flip() +
  labs(title = "Causes of CA Fires", x = "Causes of Fire", y = "Number of Fires")
```
<<<<<<< HEAD

```{r}
# With this visualization, we see that the values for 2007-2017 are increased across the board. Whereas in 1950-1960, about 400 wildfires were attributed to human intervention, in the latter dataset, that number is closer to 1700. Similarly, natural fires have increased to 1000 from 200.Also, number and proportion of unknown fires has decreased which may point to better detection. 
ca_fires %>%
  filter(year_ %in% c(seq(1950,1960, 1))) %>%
  group_by(cause2) %>%
  count() %>%
  ggplot(aes(x = cause2, y = n)) +
  geom_col()

ca_fires %>%
  filter(year_ %in% c(seq(2007,2017, 1))) %>%
  group_by(cause2) %>%
  count() %>%
  ggplot(aes(x = cause2, y = n)) +
  geom_col()
```


```{r}
#Was trying to look at the length of fire vs cause of fire. However, there are ~7000 fires that are missing data on their alarm/cont date. 
ca_fires %>% 
  mutate(total_days = cont_date - alarm_date) %>% 
  
ggplot(aes(x = total_days, fill = cause2)) +
  geom_histogram() +
  facet_wrap(vars(cause2)) +
  xlim(0,200) +
  ylim(0, 500) +
  labs(y = "Total Number of Fires")
```

```{r}
#quick plot showing how total gis acres has been increasing. 
ca_fires %>%
  group_by(year_) %>%
  summarize(total_acres = sum(gis_acres, na.rm = TRUE)) %>%
  left_join(ca_damage, by = c("year_" = "year")) %>%
  arrange(desc(year_)) %>% 

ggplot(aes(x = year_, y = total_acres)) +
  geom_line() +
  geom_smooth(se = FALSE)
```

```{r}
#visualization showing the amount of CA that experienced a fire, per year, as a proportion of total area of CA. 
#okay, not the best comparison, but I was thinking it could be interesting to look at how the total gis_acres is pretty big.
ca_fires %>%  #using summarize
  group_by(year_) %>% 
  summarize(total_gis_acres = sum(gis_acres)) %>% 
  
ggplot(aes(x = year_, y = total_gis_acres)) + #visualization of gis_acres each year 
  geom_col()

ca_fires %>%  #using summarize
  group_by(year_) %>% 
  summarize(total_gis_acres = sum(gis_acres)) %>% 
  add_column("Size_of_CA" = 104765000) %>% 
  mutate(perc_of_CA = ((total_gis_acres / Size_of_CA) * 100)) %>% 
  
ggplot(aes(x = year_, y = perc_of_CA)) +
  geom_point() +
  geom_smooth()
```

```{r}
#size of Rhode Island; I think eventually putting this on a map for size of fires imposed over a map of something. 
ca_fires %>%  #using summarize
  group_by(year_) %>% 
  summarize(total_gis_acres = sum(gis_acres)) %>% 
  add_column("Size_of_RI" = 775900) %>% 
  mutate(perc_of_RI = ((total_gis_acres / Size_of_RI) * 100)) %>% 
  
ggplot(aes(x = year_, y = perc_of_RI)) +
  geom_point() +
  geom_smooth()
```




